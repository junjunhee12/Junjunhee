<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login</title>
    <link rel="stylesheet" href="../CSS/login.css" />
    <link rel="stylesheet" href="../CSS/total.css" />
  </head>
  <body>
    <p id="click">로그인</p>

    <!-- <form action="..."> -->
    <div class="modal-back">
      <div class="modal-page">
        <!-- legend 블럭요소 -->
        <div class="close-box">
          <div class="modal-close">
            <!-- <iconify-icon
              class="icon"
              icon="icon-park-solid:big-x"
            ></iconify-icon> -->X
          </div>
        </div>
        <div class="modal-header">로그인</div>
        <p id="come">FTT에 오신것을 환영합니다.</p>
        <table>
          <tr>
            <th>아이디</th>
            <td>
              <input type="text" name="id" placeholder="아이디 10글자 이내" />
            </td>
            <!-- <td><input type="button" value="중복 확인" /></td> -->
          </tr>
          <tr>
            <th>비밀번호</th>
            <td>
              <input
                type="password"
                name="password"
                placeholder="영문,숫자,특수문자 포함 8자 이상"
              />
            </td>
          </tr>
        </table>
        <div class="modal-check">
          <input type="button" name="check" value="확인" class="login-go" />
          <!-- <input type="button" name="cancel" value="취소" /> -->
        </div>
        <div class="modal-find">
          <a href="#">아이디 찾기</a>
          <a href="#">비밀번호 찾기</a>
          <a href="signUp.html">회원가입</a>
        </div>
        <ul class="modal-footer">
          <li>이용약관</li>
          <li>개인정보처리방침</li>
          <li>고객센터</li>
        </ul>
      </div>
    </div>
  </body>
  <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
  <script src="../JS/login.js"></script>
  <script type="module">
    import * as firebase from "../JS/firebase.js";
    const {
      db,
      getDocs,
      collection,
      setDoc,
      addDoc,
      getDatas,
      doc,
      addDatas,
      deleteDatas,
      updateDatas,
      deleteField,
    } = firebase;

    const checkBtn = document.querySelector("input[name = check]");
    const id = document.querySelector("input[name = id]").value;
    const password = document.querySelector("input[name = password]").value;

    checkBtn.addEventListener("click", async function () {
      const snapshot = await getDatas("FTT");
      snapshot.forEach((doc) => {
        const { memberId, memberPassword } = doc.data();

        if (document.querySelector("input[name = id]").value == memberId) {
          console.log("1");
          if (
            document.querySelector("input[name = password]").value ==
            memberPassword
          ) {
            console.log("2");
            location.href = "http://127.0.0.1:5501/index/HTML/main.html";
          } else {
            alert("비밀번호를 다시 입력해주세요");
            console.log("3");
          }
        } else {
          console.log("먼저실행");
        }
      });
    });
    // })
  </script>
</html>
